"use strict";var _interopRequireDefault=require("@babel/runtime-corejs3/helpers/interopRequireDefault"),_construct=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/reflect/construct")),_typeof2=_interopRequireDefault(require("@babel/runtime-corejs3/helpers/typeof")),_map=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/map")),_isArray=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/array/is-array")),_create=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/create")),_defineProperty=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/define-property")),_forEach=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/for-each")),_keys=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/keys")),_concat=_interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/concat")),PREFIX_BEAN="__bean__",getFieldWithPrefix=function(field){var _context;return(0,_concat.default)(_context="".concat(PREFIX_BEAN)).call(_context,field)},getProperties=function(instance){return(0,_keys.default)(instance)},forEachFields=function(properties,fn){for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];(0,_forEach.default)(properties).call(properties,(function(field){var _context2;fn&&fn.apply(void 0,(0,_concat.default)(_context2=[field]).call(_context2,args))}))},setFieldHidden=function(field,instance){var beanField=getFieldWithPrefix(field);if(beanField in instance){var oldVal=instance[beanField];delete instance[beanField],(0,_defineProperty.default)(instance,beanField,{value:oldVal,enumerable:!1,configurable:!0,writable:!0})}},filterField=function(obj,instance){var result=(0,_create.default)(null);return forEachFields(getProperties(instance),(function(field){var beanField=getFieldWithPrefix(field);result[field]=beanField in instance?dataPick(obj[field],instance[beanField]):obj[field]})),result},jsonPick=function(data,instance){return(0,_isArray.default)(data)?(0,_map.default)(data).call(data,(function(item){return filterField(item,instance)})):filterField(data,instance)},dataPick=function(data,classType){if(!data||"object"!==(0,_typeof2.default)(data))return data;if(!classType||"function"!=typeof classType&&"object"!==(0,_typeof2.default)(classType))throw new Error("The second param is expected to be a function or object");var instance;return"function"==typeof classType?instance=(0,_construct.default)(classType,[]):forEachFields(getProperties(instance=classType),setFieldHidden,instance),jsonPick(data,instance)};module.exports={dataPick:dataPick,PREFIX_BEAN:PREFIX_BEAN};